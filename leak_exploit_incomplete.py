# in the final days of the competition, a data leak was disclosed related
# to the ordering of train and test data.  I began to write code to attempt
# to incorporate it into my model (as many competitors seemed to be doing)
# but did not have time to implement it correctly

#train
f_train = pd.read_csv('input/gender_age_train.csv',
                      index_col='device_id')
f_train = f_train.reset_index()
f_train['row'] = f_train.index
f_train['n_row'] = f_train.row.apply(lambda x: x/74645.)
#mod
f_train['n_2'] = f_train.row.apply(lambda x: x%2)
f_train['n_3'] = f_train.row.apply(lambda x: x%3)
f_train['n_4'] = f_train.row.apply(lambda x: x%4)
f_train['n_5'] = f_train.row.apply(lambda x: x%5)
f_train['n_6'] = f_train.row.apply(lambda x: x%6)
f_train['n_7'] = f_train.row.apply(lambda x: x%7)
f_train['n_8'] = f_train.row.apply(lambda x: x%8)
f_train['n_9'] = f_train.row.apply(lambda x: x%9)
f_train['n_10'] = f_train.row.apply(lambda x: x%10)
f_train['n_11'] = f_train.row.apply(lambda x: x%11)
f_train['n_12'] = f_train.row.apply(lambda x: x%12)
f_train['n_13'] = f_train.row.apply(lambda x: x%12)

f_train = f_train.set_index('device_id')
f_train = f_train.drop(['gender','age','group','row'],axis=1)


#test
f_test = pd.read_csv('input/gender_age_test.csv',
                     index_col = 'device_id')
f_test = f_test.reset_index()
f_test['row'] = f_test.index
f_test['n_row'] = f_test.row.apply(lambda x: x/112071.)
#mod
f_test['n_2'] = f_test.row.apply(lambda x: x%2)
f_test['n_3'] = f_test.row.apply(lambda x: x%3)
f_test['n_4'] = f_test.row.apply(lambda x: x%4)
f_test['n_5'] = f_test.row.apply(lambda x: x%5)
f_test['n_6'] = f_test.row.apply(lambda x: x%6)
f_test['n_7'] = f_test.row.apply(lambda x: x%7)
f_test['n_8'] = f_test.row.apply(lambda x: x%8)
f_test['n_9'] = f_test.row.apply(lambda x: x%9)
f_test['n_10'] = f_test.row.apply(lambda x: x%10)
f_test['n_11'] = f_test.row.apply(lambda x: x%11)
f_test['n_12'] = f_test.row.apply(lambda x: x%12)
f_test['n_13'] = f_test.row.apply(lambda x: x%13)

f_test = f_test.set_index('device_id')
f_test = f_test.drop(['row'],axis=1)